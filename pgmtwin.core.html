
<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>pgmtwin.core package &#8212; pgmtwin 0.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d75fae25" />
    <link rel="stylesheet" type="text/css" href="_static/bizstyle.css?v=5283bb3d" />
    
    <script src="_static/documentation_options.js?v=d45e8c67"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="pgmtwin.core.asset_components package" href="pgmtwin.core.asset_components.html" />
    <link rel="prev" title="pgmtwin package" href="pgmtwin.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <!--[if lt IE 9]>
    <script src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="pgmtwin.core.asset_components.html" title="pgmtwin.core.asset_components package"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="pgmtwin.html" title="pgmtwin package"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pgmtwin 0.0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="modules.html" >pgmtwin</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="pgmtwin.html" accesskey="U">pgmtwin package</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">pgmtwin.core package</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="pgmtwin-core-package">
<h1>pgmtwin.core package<a class="headerlink" href="#pgmtwin-core-package" title="Link to this heading">¶</a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Link to this heading">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="pgmtwin.core.asset_components.html">pgmtwin.core.asset_components package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pgmtwin.core.asset_components.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="pgmtwin.core.asset_components.html#module-pgmtwin.core.asset_components.observation_noise">pgmtwin.core.asset_components.observation_noise module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pgmtwin.core.asset_components.html#pgmtwin.core.asset_components.observation_noise.BaseObservationNoiseComponent"><code class="docutils literal notranslate"><span class="pre">BaseObservationNoiseComponent</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="pgmtwin.core.asset_components.html#pgmtwin.core.asset_components.observation_noise.BaseObservationNoiseComponent.apply_noise"><code class="docutils literal notranslate"><span class="pre">BaseObservationNoiseComponent.apply_noise()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pgmtwin.core.asset_components.html#pgmtwin.core.asset_components.observation_noise.GaussianNoiseComponent"><code class="docutils literal notranslate"><span class="pre">GaussianNoiseComponent</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="pgmtwin.core.asset_components.html#pgmtwin.core.asset_components.observation_noise.GaussianNoiseComponent.apply_noise"><code class="docutils literal notranslate"><span class="pre">GaussianNoiseComponent.apply_noise()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pgmtwin.core.asset_components.html#pgmtwin.core.asset_components.observation_noise.SNRGaussianNoiseComponent"><code class="docutils literal notranslate"><span class="pre">SNRGaussianNoiseComponent</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="pgmtwin.core.asset_components.html#pgmtwin.core.asset_components.observation_noise.SNRGaussianNoiseComponent.apply_noise"><code class="docutils literal notranslate"><span class="pre">SNRGaussianNoiseComponent.apply_noise()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pgmtwin.core.asset_components.html#module-pgmtwin.core.asset_components.observer">pgmtwin.core.asset_components.observer module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pgmtwin.core.asset_components.html#pgmtwin.core.asset_components.observer.DatabaseObserverComponent"><code class="docutils literal notranslate"><span class="pre">DatabaseObserverComponent</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="pgmtwin.core.asset_components.html#pgmtwin.core.asset_components.observer.DatabaseObserverComponent.get_observation"><code class="docutils literal notranslate"><span class="pre">DatabaseObserverComponent.get_observation()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pgmtwin.core.asset_components.html#pgmtwin.core.asset_components.observer.ObserverComponent"><code class="docutils literal notranslate"><span class="pre">ObserverComponent</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="pgmtwin.core.asset_components.html#pgmtwin.core.asset_components.observer.ObserverComponent.get_observation"><code class="docutils literal notranslate"><span class="pre">ObserverComponent.get_observation()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pgmtwin.core.asset_components.html#module-pgmtwin.core.asset_components.state_update">pgmtwin.core.asset_components.state_update module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pgmtwin.core.asset_components.html#pgmtwin.core.asset_components.state_update.ActionUpdateComponent"><code class="docutils literal notranslate"><span class="pre">ActionUpdateComponent</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="pgmtwin.core.asset_components.html#pgmtwin.core.asset_components.state_update.ActionUpdateComponent.step"><code class="docutils literal notranslate"><span class="pre">ActionUpdateComponent.step()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pgmtwin.core.asset_components.html#pgmtwin.core.asset_components.state_update.IsolatedRngStateUpdateComponent"><code class="docutils literal notranslate"><span class="pre">IsolatedRngStateUpdateComponent</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="pgmtwin.core.asset_components.html#pgmtwin.core.asset_components.state_update.IsolatedRngStateUpdateComponent.step"><code class="docutils literal notranslate"><span class="pre">IsolatedRngStateUpdateComponent.step()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pgmtwin.core.asset_components.html#pgmtwin.core.asset_components.state_update.StateUpdateComponent"><code class="docutils literal notranslate"><span class="pre">StateUpdateComponent</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="pgmtwin.core.asset_components.html#pgmtwin.core.asset_components.state_update.StateUpdateComponent.step"><code class="docutils literal notranslate"><span class="pre">StateUpdateComponent.step()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pgmtwin.core.asset_components.html#module-pgmtwin.core.asset_components">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pgmtwin.core.distributions.html">pgmtwin.core.distributions package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pgmtwin.core.distributions.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="pgmtwin.core.distributions.html#module-pgmtwin.core.distributions.base">pgmtwin.core.distributions.base module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pgmtwin.core.distributions.html#pgmtwin.core.distributions.base.BayesModel"><code class="docutils literal notranslate"><span class="pre">BayesModel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="pgmtwin.core.distributions.html#pgmtwin.core.distributions.base.BayesModel.cdf"><code class="docutils literal notranslate"><span class="pre">BayesModel.cdf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pgmtwin.core.distributions.html#pgmtwin.core.distributions.base.BayesModel.mean"><code class="docutils literal notranslate"><span class="pre">BayesModel.mean()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pgmtwin.core.distributions.html#pgmtwin.core.distributions.base.BayesModel.mode"><code class="docutils literal notranslate"><span class="pre">BayesModel.mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pgmtwin.core.distributions.html#pgmtwin.core.distributions.base.BayesModel.pdf"><code class="docutils literal notranslate"><span class="pre">BayesModel.pdf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pgmtwin.core.distributions.html#pgmtwin.core.distributions.base.BayesModel.posterior"><code class="docutils literal notranslate"><span class="pre">BayesModel.posterior()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pgmtwin.core.distributions.html#pgmtwin.core.distributions.base.BayesModel.ppf"><code class="docutils literal notranslate"><span class="pre">BayesModel.ppf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pgmtwin.core.distributions.html#pgmtwin.core.distributions.base.BayesModel.sample"><code class="docutils literal notranslate"><span class="pre">BayesModel.sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pgmtwin.core.distributions.html#pgmtwin.core.distributions.base.BayesModel.update"><code class="docutils literal notranslate"><span class="pre">BayesModel.update()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pgmtwin.core.distributions.html#module-pgmtwin.core.distributions.beta_bernoulli">pgmtwin.core.distributions.beta_bernoulli module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pgmtwin.core.distributions.html#pgmtwin.core.distributions.beta_bernoulli.BetaBernoulli"><code class="docutils literal notranslate"><span class="pre">BetaBernoulli</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="pgmtwin.core.distributions.html#pgmtwin.core.distributions.beta_bernoulli.BetaBernoulli.cdf"><code class="docutils literal notranslate"><span class="pre">BetaBernoulli.cdf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pgmtwin.core.distributions.html#pgmtwin.core.distributions.beta_bernoulli.BetaBernoulli.conditional_value_at_risk"><code class="docutils literal notranslate"><span class="pre">BetaBernoulli.conditional_value_at_risk()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pgmtwin.core.distributions.html#pgmtwin.core.distributions.beta_bernoulli.BetaBernoulli.expected_value"><code class="docutils literal notranslate"><span class="pre">BetaBernoulli.expected_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pgmtwin.core.distributions.html#pgmtwin.core.distributions.beta_bernoulli.BetaBernoulli.mean"><code class="docutils literal notranslate"><span class="pre">BetaBernoulli.mean()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pgmtwin.core.distributions.html#pgmtwin.core.distributions.beta_bernoulli.BetaBernoulli.mode"><code class="docutils literal notranslate"><span class="pre">BetaBernoulli.mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pgmtwin.core.distributions.html#pgmtwin.core.distributions.beta_bernoulli.BetaBernoulli.pdf"><code class="docutils literal notranslate"><span class="pre">BetaBernoulli.pdf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pgmtwin.core.distributions.html#pgmtwin.core.distributions.beta_bernoulli.BetaBernoulli.plot"><code class="docutils literal notranslate"><span class="pre">BetaBernoulli.plot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pgmtwin.core.distributions.html#pgmtwin.core.distributions.beta_bernoulli.BetaBernoulli.posterior"><code class="docutils literal notranslate"><span class="pre">BetaBernoulli.posterior()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pgmtwin.core.distributions.html#pgmtwin.core.distributions.beta_bernoulli.BetaBernoulli.ppf"><code class="docutils literal notranslate"><span class="pre">BetaBernoulli.ppf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pgmtwin.core.distributions.html#pgmtwin.core.distributions.beta_bernoulli.BetaBernoulli.predict"><code class="docutils literal notranslate"><span class="pre">BetaBernoulli.predict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pgmtwin.core.distributions.html#pgmtwin.core.distributions.beta_bernoulli.BetaBernoulli.sample"><code class="docutils literal notranslate"><span class="pre">BetaBernoulli.sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pgmtwin.core.distributions.html#pgmtwin.core.distributions.beta_bernoulli.BetaBernoulli.update"><code class="docutils literal notranslate"><span class="pre">BetaBernoulli.update()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pgmtwin.core.distributions.html#pgmtwin.core.distributions.beta_bernoulli.BetaBernoulli.value_at_risk"><code class="docutils literal notranslate"><span class="pre">BetaBernoulli.value_at_risk()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pgmtwin.core.distributions.html#module-pgmtwin.core.distributions.cathegorical_dirichlet">pgmtwin.core.distributions.cathegorical_dirichlet module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pgmtwin.core.distributions.html#pgmtwin.core.distributions.cathegorical_dirichlet.DirichletMultinomial"><code class="docutils literal notranslate"><span class="pre">DirichletMultinomial</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="pgmtwin.core.distributions.html#pgmtwin.core.distributions.cathegorical_dirichlet.DirichletMultinomial.cdf"><code class="docutils literal notranslate"><span class="pre">DirichletMultinomial.cdf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pgmtwin.core.distributions.html#pgmtwin.core.distributions.cathegorical_dirichlet.DirichletMultinomial.mean"><code class="docutils literal notranslate"><span class="pre">DirichletMultinomial.mean()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pgmtwin.core.distributions.html#pgmtwin.core.distributions.cathegorical_dirichlet.DirichletMultinomial.mode"><code class="docutils literal notranslate"><span class="pre">DirichletMultinomial.mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pgmtwin.core.distributions.html#pgmtwin.core.distributions.cathegorical_dirichlet.DirichletMultinomial.pdf"><code class="docutils literal notranslate"><span class="pre">DirichletMultinomial.pdf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pgmtwin.core.distributions.html#pgmtwin.core.distributions.cathegorical_dirichlet.DirichletMultinomial.posterior"><code class="docutils literal notranslate"><span class="pre">DirichletMultinomial.posterior()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pgmtwin.core.distributions.html#pgmtwin.core.distributions.cathegorical_dirichlet.DirichletMultinomial.ppf"><code class="docutils literal notranslate"><span class="pre">DirichletMultinomial.ppf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pgmtwin.core.distributions.html#pgmtwin.core.distributions.cathegorical_dirichlet.DirichletMultinomial.sample"><code class="docutils literal notranslate"><span class="pre">DirichletMultinomial.sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pgmtwin.core.distributions.html#pgmtwin.core.distributions.cathegorical_dirichlet.DirichletMultinomial.update"><code class="docutils literal notranslate"><span class="pre">DirichletMultinomial.update()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pgmtwin.core.distributions.html#module-pgmtwin.core.distributions">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">¶</a></h2>
</section>
<section id="module-pgmtwin.core.action">
<span id="pgmtwin-core-action-module"></span><h2>pgmtwin.core.action module<a class="headerlink" href="#module-pgmtwin.core.action" title="Link to this heading">¶</a></h2>
<p>Base implementations of of Actions for the state update of a PhysicalAsset</p>
<dl class="py class">
<dt class="sig sig-object py" id="pgmtwin.core.action.ActionCPD">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pgmtwin.core.action.</span></span><span class="sig-name descname"><span class="pre">ActionCPD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_probabilities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.action.ActionCPD" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pgmtwin.core.action.BaseAction" title="pgmtwin.core.action.BaseAction"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseAction</span></code></a></p>
<p>Implements a static transition table for the state update</p>
<p>Sets the action’s name and discrete domain</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – the name of the action</p></li>
<li><p><strong>state_domain</strong> (<a class="reference internal" href="#pgmtwin.core.domain.DiscreteDomain" title="pgmtwin.core.domain.DiscreteDomain"><em>DiscreteDomain</em></a>) – the discrete domain of the action’s state</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pgmtwin.core.action.ActionCPD.apply">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_deterministic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_deterministic</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.action.ActionCPD.apply" title="Link to this definition">¶</a></dt>
<dd><p>Retrieves the transition outcome</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<em>np.ndarray</em>) – input state</p></li>
<li><p><strong>input_deterministic</strong> (<em>bool</em>) – whether to treat the input state as values (True) or as a probability distribution (False)</p></li>
<li><p><strong>output_deterministic</strong> (<em>bool</em>) – whether to return the outcome as values (True) or as a probability distribution (False)</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – if the input state is not a valid element of the domain, or if it is not a valid distribution for the domain</p></li>
<li><p><strong>ValueError</strong> – if the input state size does not match the domain size</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the output state, given as value record or distribution</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pgmtwin.core.action.ActionCPD.get_transition_probabilities">
<span class="sig-name descname"><span class="pre">get_transition_probabilities</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.action.ActionCPD.get_transition_probabilities" title="Link to this definition">¶</a></dt>
<dd><p>Concretizes the transition probabilities
Returns a 2d (n_states, n_states) matrix whose columns sum to 1</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a 2d (n_states, n_states) matrix whose columns sum to 1</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pgmtwin.core.action.BaseAction">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pgmtwin.core.action.</span></span><span class="sig-name descname"><span class="pre">BaseAction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_domain</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.action.BaseAction" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Models a transition between elements of a discrete state domain.
This base class doesn’t implement any actual transition table
and is to be used by an external update model.</p>
<p>Sets the action’s name and discrete domain</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – the name of the action</p></li>
<li><p><strong>state_domain</strong> (<a class="reference internal" href="#pgmtwin.core.domain.DiscreteDomain" title="pgmtwin.core.domain.DiscreteDomain"><em>DiscreteDomain</em></a>) – the discrete domain of the action’s state</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pgmtwin.core.action.BaseAction.apply">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_deterministic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_deterministic</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.action.BaseAction.apply" title="Link to this definition">¶</a></dt>
<dd><p>Applies the transition from the given state
Handles all cases of deterministic/stochastic inputs/outputs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<em>np.ndarray</em>) – the input state, given as value record</p></li>
<li><p><strong>input_deterministic</strong> (<em>bool</em>) – whether the given state is a value record, or a distribution</p></li>
<li><p><strong>output_deterministic</strong> (<em>bool</em>) – whether the output is to be given as a value record, or a distribution</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the output state, given as value record or distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pgmtwin.core.action.BaseAction.get_transition_probabilities">
<span class="sig-name descname"><span class="pre">get_transition_probabilities</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.action.BaseAction.get_transition_probabilities" title="Link to this definition">¶</a></dt>
<dd><p>Concretizes the transition probabilities
Returns a 2d (n_states, n_states) matrix whose columns sum to 1</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a 2d (n_states, n_states) matrix whose columns sum to 1</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pgmtwin.core.action.plot_action_transitions">
<span class="sig-prename descclassname"><span class="pre">pgmtwin.core.action.</span></span><span class="sig-name descname"><span class="pre">plot_action_transitions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorbar=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap=&lt;matplotlib.colors.ListedColormap</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.action.plot_action_transitions" title="Link to this definition">¶</a></dt>
<dd><p>Helper method to represent the state transition matrix with the value labels</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>action</strong> (<a class="reference internal" href="#pgmtwin.core.action.ActionCPD" title="pgmtwin.core.action.ActionCPD"><em>ActionCPD</em></a>) – the action to be represented</p></li>
<li><p><strong>colorbar</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether to draw a colorbar. Defaults to True.</p></li>
<li><p><strong>cmap</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Colormap</em><em>]</em><em>, </em><em>optional</em>) – colormap for the transitions. Defaults to CMAP_BLUES.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pgmtwin.core.dependency">
<span id="pgmtwin-core-dependency-module"></span><h2>pgmtwin.core.dependency module<a class="headerlink" href="#module-pgmtwin.core.dependency" title="Link to this heading">¶</a></h2>
<p>Definitions for the metadata of a variable dependency in a Probabilistic Graphical Model
Such metadata are used during construction of the underlying DynamicBayesianNetwork</p>
<dl class="py class">
<dt class="sig sig-object py" id="pgmtwin.core.dependency.Dependency">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pgmtwin.core.dependency.</span></span><span class="sig-name descname"><span class="pre">Dependency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.dependency.Dependency" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Specifies the inputs, output and, optionally, the cpd of relationships between variables in a Probabilistic Graphical Model</p>
<p>Sets the features of the dependency between variables, to be used as metadata for the construction of a DynamicBayesianNetwork</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – the name of the dependency</p></li>
<li><p><strong>inputs</strong> (<em>Sequence</em><em>[</em><em>Tuple</em><em>[</em><a class="reference internal" href="#pgmtwin.core.variable.Variable" title="pgmtwin.core.variable.Variable"><em>Variable</em></a><em>, </em><em>int</em><em>]</em><em>]</em>) – sequence of variables and their observation frame</p></li>
<li><p><strong>output</strong> (<em>Tuple</em><em>[</em><a class="reference internal" href="#pgmtwin.core.variable.Variable" title="pgmtwin.core.variable.Variable"><em>Variable</em></a><em>, </em><em>int</em><em>]</em>) – the output variable and its observation frame</p></li>
<li><p><strong>cpd</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – conditional probability distribution, given as an array of shape (cardinality of output, prod(cardinalities of inputs)). Defaults to None.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pgmtwin.core.dependency.Dependency.get_timestep_copy">
<span class="sig-name descname"><span class="pre">get_timestep_copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.dependency.Dependency.get_timestep_copy" title="Link to this definition">¶</a></dt>
<dd><p>Generates a copy of this dependency, where all frame values are incremented by d</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>d</strong> (<em>int</em>) – the frame increment</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a new Dependency instance with incremented frame values</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#pgmtwin.core.dependency.Dependency" title="pgmtwin.core.dependency.Dependency">Dependency</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pgmtwin.core.dependency.Dependency.merge">
<span class="sig-name descname"><span class="pre">merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpd_smoothing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.dependency.Dependency.merge" title="Link to this definition">¶</a></dt>
<dd><p>Creates a new dependenccy that combines the current one and other
The inputs are concatenated and the cpds are combined</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#pgmtwin.core.dependency.Dependency" title="pgmtwin.core.dependency.Dependency"><em>Dependency</em></a>) – the other dependency to merge with this one</p></li>
<li><p><strong>cpd_smoothing</strong> (<em>bool</em><em>, </em><em>optional</em>) – smoothing when normalizing combined cpds. Defaults to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a new Dependency instance that combines the current one and other</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#pgmtwin.core.dependency.Dependency" title="pgmtwin.core.dependency.Dependency">Dependency</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-pgmtwin.core.digital_asset">
<span id="pgmtwin-core-digital-asset-module"></span><h2>pgmtwin.core.digital_asset module<a class="headerlink" href="#module-pgmtwin.core.digital_asset" title="Link to this heading">¶</a></h2>
<p>Base abstract class for a DigitalAsset, holding a state distribution
Encapsulates the assimilation of observations through an inverse problem</p>
<dl class="py class">
<dt class="sig sig-object py" id="pgmtwin.core.digital_asset.BaseDigitalAsset">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pgmtwin.core.digital_asset.</span></span><span class="sig-name descname"><span class="pre">BaseDigitalAsset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_distro</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.digital_asset.BaseDigitalAsset" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Holds a state distribution and updates based on observations</p>
<p>Initializes the DigitalAsset’s internal objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state_domain</strong> (<a class="reference internal" href="#pgmtwin.core.domain.DiscreteDomain" title="pgmtwin.core.domain.DiscreteDomain"><em>DiscreteDomain</em></a>) – the discrete domain of the state</p></li>
<li><p><strong>state_distro</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – the initial probability distribution of the state.</p></li>
<li><p><strong>None</strong> (<em>If</em>)</p></li>
<li><p><strong>None.</strong> (<em>it is initialized with a uniform distribution. Defaults to</em>)</p></li>
<li><p><strong>rng</strong> (<em>np.random.Generator</em><em>, </em><em>optional</em>) – the pseudo-random generator, or None to create a new one. Defaults to None.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pgmtwin.core.digital_asset.BaseDigitalAsset.assimilate">
<span class="sig-name descname"><span class="pre">assimilate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observations</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.digital_asset.BaseDigitalAsset.assimilate" title="Link to this definition">¶</a></dt>
<dd><p>Sets the internal digital state to the distribution computed from the given observations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>observations</strong> (<em>np.ndarray</em>) – array of observations</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the updated state distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pgmtwin.core.digital_asset.BaseDigitalAsset.get_assimilation">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_assimilation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observations</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.digital_asset.BaseDigitalAsset.get_assimilation" title="Link to this definition">¶</a></dt>
<dd><p>Solves the inverse problem for multiple observation records, returns the corresponding digital states</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>observations</strong> (<em>np.ndarray</em>) – array of observation records</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>array of inverse problem solutions, one for each input observation record</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pgmtwin.core.digital_asset.BaseDigitalAsset.get_assimilation_distribution">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_assimilation_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observations</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.digital_asset.BaseDigitalAsset.get_assimilation_distribution" title="Link to this definition">¶</a></dt>
<dd><p>Retrieves the digital state distribution from the inverse problem solutions of a set of observations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>observations</strong> (<em>np.ndarray</em>) – array of observation records</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the state distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pgmtwin.core.digital_asset.BaseDigitalAsset.reset_state_distribution">
<span class="sig-name descname"><span class="pre">reset_state_distribution</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.digital_asset.BaseDigitalAsset.reset_state_distribution" title="Link to this definition">¶</a></dt>
<dd><p>Reset the state distribution to be uniform</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the updated state distribution</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pgmtwin.core.digital_asset.InverseProblemConfusionDigitalAsset">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pgmtwin.core.digital_asset.</span></span><span class="sig-name descname"><span class="pre">InverseProblemConfusionDigitalAsset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inv_solver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inv_solver_confusion_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_distro</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.digital_asset.InverseProblemConfusionDigitalAsset" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pgmtwin.core.digital_asset.BaseDigitalAsset" title="pgmtwin.core.digital_asset.BaseDigitalAsset"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseDigitalAsset</span></code></a></p>
<p>Holds a state distribution and provides uncertainty quantification of the digital state via the inverse problem’s confusion matrix</p>
<p>Initializes the DigitalAsset with the given parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state_domain</strong> (<a class="reference internal" href="#pgmtwin.core.domain.DiscreteDomain" title="pgmtwin.core.domain.DiscreteDomain"><em>DiscreteDomain</em></a>) – the domain of the digital asset</p></li>
<li><p><strong>inv_solver</strong> (<em>Callable</em><em>[</em><em>[</em><em>np.ndarray</em><em>]</em><em>, </em><em>np.ndarray</em><em>]</em>) – a callable that solves the inverse problem</p></li>
<li><p><strong>inv_solver_confusion_matrix</strong> (<em>np.ndarray</em>) – the confusion matrix for the inverse solver</p></li>
<li><p><strong>state_distro</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – the initial probability distribution of the state.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pgmtwin.core.digital_asset.InverseProblemConfusionDigitalAsset.assimilate">
<span class="sig-name descname"><span class="pre">assimilate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observations</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.digital_asset.InverseProblemConfusionDigitalAsset.assimilate" title="Link to this definition">¶</a></dt>
<dd><p>Sets the internal digital state to the distribution computed from the given observations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>observations</strong> (<em>np.ndarray</em>) – array of observations</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the updated state distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pgmtwin.core.digital_asset.InverseProblemConfusionDigitalAsset.get_assimilation">
<span class="sig-name descname"><span class="pre">get_assimilation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observations</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.digital_asset.InverseProblemConfusionDigitalAsset.get_assimilation" title="Link to this definition">¶</a></dt>
<dd><p>Solves the inverse problem for multiple observation records, returns the corresponding digital states</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>observations</strong> (<em>np.ndarray</em>) – array of observation records</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>array of inverse problem solutions, one for each input observation record</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pgmtwin.core.digital_asset.InverseProblemConfusionDigitalAsset.get_assimilation_cpd">
<span class="sig-name descname"><span class="pre">get_assimilation_cpd</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.digital_asset.InverseProblemConfusionDigitalAsset.get_assimilation_cpd" title="Link to this definition">¶</a></dt>
<dd><p>Retrieve the assimilation CPD, which is the inverse solver’s confidence matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the inverse solver’s confidence matrix</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pgmtwin.core.digital_asset.InverseProblemConfusionDigitalAsset.get_assimilation_distribution">
<span class="sig-name descname"><span class="pre">get_assimilation_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observations</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.digital_asset.InverseProblemConfusionDigitalAsset.get_assimilation_distribution" title="Link to this definition">¶</a></dt>
<dd><p>Retrieves the digital state distribution from the inverse problem solutions of a set of observations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>observations</strong> (<em>np.ndarray</em>) – array of observation records</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the state distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-pgmtwin.core.domain">
<span id="pgmtwin-core-domain-module"></span><h2>pgmtwin.core.domain module<a class="headerlink" href="#module-pgmtwin.core.domain" title="Link to this heading">¶</a></h2>
<p>Base implementation of classes to handle domains</p>
<dl class="py class">
<dt class="sig sig-object py" id="pgmtwin.core.domain.DiscreteDomain">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pgmtwin.core.domain.</span></span><span class="sig-name descname"><span class="pre">DiscreteDomain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var2values</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.domain.DiscreteDomain" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A multi-dimensional discrete domain
Enables conversions from/to value records, index records, and multi indices of each dimension</p>
<p>Initializes the DiscreteDomain with a mapping of variable names to their possible values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>var2values</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>np.ndarray</em><em>]</em>) – a dictionary mapping variable names to their possible values.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pgmtwin.core.domain.DiscreteDomain.index2multi_index">
<span class="sig-name descname"><span class="pre">index2multi_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.domain.DiscreteDomain.index2multi_index" title="Link to this definition">¶</a></dt>
<dd><p>Converts an array of indices to the corresponding multi indices in the domain</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>indices</strong> (<em>np.ndarray</em>) – a scalar index or 1d array of indices</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a 1d or 2d array of multi indices</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pgmtwin.core.domain.DiscreteDomain.index2values">
<span class="sig-name descname"><span class="pre">index2values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.domain.DiscreteDomain.index2values" title="Link to this definition">¶</a></dt>
<dd><p>Converts an array of indices to the corresponding values in the domain</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>indices</strong> (<em>np.ndarray</em>) – a scalar index or 1d array of indices</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a 1d or 2d array of value records</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pgmtwin.core.domain.DiscreteDomain.merge_domains">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">merge_domains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domains</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.domain.DiscreteDomain.merge_domains" title="Link to this definition">¶</a></dt>
<dd><p>Generate a new DiscreteDomain instance, concatenating the dimensions of the given domain</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>domains</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#pgmtwin.core.domain.DiscreteDomain" title="pgmtwin.core.domain.DiscreteDomain"><em>DiscreteDomain</em></a><em>]</em>) – a sequence of DiscreteDomain instances to merge</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a new DiscreteDomain instance with the merged dimensions</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#pgmtwin.core.domain.DiscreteDomain" title="pgmtwin.core.domain.DiscreteDomain">DiscreteDomain</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pgmtwin.core.domain.DiscreteDomain.multi_index2index">
<span class="sig-name descname"><span class="pre">multi_index2index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m_indices</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.domain.DiscreteDomain.multi_index2index" title="Link to this definition">¶</a></dt>
<dd><p>Converts an array of multi indices to the corresponding indices in the domain</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>m_indices</strong> (<em>np.ndarray</em>) – a 1d or 2d array of multi indices</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a scalar index or 1d array of indices</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pgmtwin.core.domain.DiscreteDomain.multi_index2values">
<span class="sig-name descname"><span class="pre">multi_index2values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m_indices</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.domain.DiscreteDomain.multi_index2values" title="Link to this definition">¶</a></dt>
<dd><p>Converts an array of multi indices to the corresponding values in the domain</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>m_indices</strong> (<em>np.ndarray</em>) – a 1d or 2d array of multi indices</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array of value records, with the same shape as the input</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pgmtwin.core.domain.DiscreteDomain.sample_indices">
<span class="sig-name descname"><span class="pre">sample_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.domain.DiscreteDomain.sample_indices" title="Link to this definition">¶</a></dt>
<dd><p>Generates samples of index records</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_samples</strong> (<em>int</em>) – number of samples to generate</p></li>
<li><p><strong>p</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – probability distribution to sample with, or None for uniform sampling. Defaults to None.</p></li>
<li><p><strong>rng</strong> (<em>np.random.Generator</em><em>, </em><em>optional</em>) – the pseudo-random generator, or None to create a new one. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a scalar index, or array of index records with shape (n_samples,)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pgmtwin.core.domain.DiscreteDomain.sample_values">
<span class="sig-name descname"><span class="pre">sample_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.domain.DiscreteDomain.sample_values" title="Link to this definition">¶</a></dt>
<dd><p>Generate samples of values records</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_samples</strong> (<em>int</em>) – number of samples to generate</p></li>
<li><p><strong>p</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – probability distribution to sample with, or None for uniform sampling. Defaults to None.</p></li>
<li><p><strong>rng</strong> (<em>np.random.Generator</em><em>, </em><em>optional</em>) – the pseudo-random generator, or None to create a new one. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array of value records, with shape (n_samples, len(self.labels))</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pgmtwin.core.domain.DiscreteDomain.values2index">
<span class="sig-name descname"><span class="pre">values2index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.domain.DiscreteDomain.values2index" title="Link to this definition">¶</a></dt>
<dd><p>Converts an array of values to the corresponding indices in the domain</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>values</strong> (<em>np.ndarray</em>) – a 1d or 2d array of value records</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a scalar index or 1d array of indices</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pgmtwin.core.domain.DiscreteDomain.values2multi_index">
<span class="sig-name descname"><span class="pre">values2multi_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.domain.DiscreteDomain.values2multi_index" title="Link to this definition">¶</a></dt>
<dd><p>Converts an array of values to the corresponding multi indices in the domain</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>values</strong> (<em>np.ndarray</em>) – a 1d or 2d array of value records</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array of multi indices, with the same shape as the input</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pgmtwin.core.domain.DiscreteDomain.values2values">
<span class="sig-name descname"><span class="pre">values2values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.domain.DiscreteDomain.values2values" title="Link to this definition">¶</a></dt>
<dd><p>Converts an array of values to the closest values in the domain</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>values</strong> (<em>np.ndarray</em>) – a 1d or 2d array of value records</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array of value records, with the same shape as the input</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-pgmtwin.core.env">
<span id="pgmtwin-core-env-module"></span><h2>pgmtwin.core.env module<a class="headerlink" href="#module-pgmtwin.core.env" title="Link to this heading">¶</a></h2>
<p>Module for the implementation of a base Env compatible with gym</p>
<dl class="py class">
<dt class="sig sig-object py" id="pgmtwin.core.env.BaseDigitalTwinEnv">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pgmtwin.core.env.</span></span><span class="sig-name descname"><span class="pre">BaseDigitalTwinEnv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">actions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">physical_asset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">digital_asset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples_assimilation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.env.BaseDigitalTwinEnv" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Env</span></code></p>
<p>Base class for an Env compatible with gym and stable-baselines, for policy training and simulation
It encapsulates the Physical and Digital assets, exposing the digital state distribution as an observation in a Box space
This base implementation does not employ a Probabilistic Graphical Model, as the Assets only communicate through the inverse problem</p>
<p>Initializes the BaseDigitalTwinEnv with the given parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state_domain</strong> (<a class="reference internal" href="#pgmtwin.core.domain.DiscreteDomain" title="pgmtwin.core.domain.DiscreteDomain"><em>DiscreteDomain</em></a>) – description of the digital state domain</p></li>
<li><p><strong>actions</strong> (<em>List</em><em>[</em><a class="reference internal" href="#pgmtwin.core.action.BaseAction" title="pgmtwin.core.action.BaseAction"><em>BaseAction</em></a><em>]</em>) – list of actions that can be applied to the physical asset</p></li>
<li><p><strong>physical_asset</strong> (<a class="reference internal" href="#pgmtwin.core.physical_asset.BasePhysicalAsset" title="pgmtwin.core.physical_asset.BasePhysicalAsset"><em>BasePhysicalAsset</em></a>) – physical asset that is being modeled</p></li>
<li><p><strong>digital_asset</strong> (<a class="reference internal" href="#pgmtwin.core.digital_asset.BaseDigitalAsset" title="pgmtwin.core.digital_asset.BaseDigitalAsset"><em>BaseDigitalAsset</em></a>) – digital asset that holds the state distribution and performs assimilation</p></li>
<li><p><strong>reward</strong> (<em>Callable</em><em>[</em><em>[</em><a class="reference internal" href="#pgmtwin.core.action.BaseAction" title="pgmtwin.core.action.BaseAction"><em>BaseAction</em></a><em>, </em><em>np.ndarray</em><em>]</em><em>, </em><em>float</em><em>]</em>) – reward function</p></li>
<li><p><strong>n_samples_assimilation</strong> (<em>int</em><em>, </em><em>optional</em>) – number of samples for sensor reading assimilation . Defaults to 1.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pgmtwin.core.env.BaseDigitalTwinEnv.metadata">
<span class="sig-name descname"><span class="pre">metadata</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict[str,</span> <span class="pre">Any]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'render_modes':</span> <span class="pre">[]}</span></em><a class="headerlink" href="#pgmtwin.core.env.BaseDigitalTwinEnv.metadata" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pgmtwin.core.env.BaseDigitalTwinEnv.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.env.BaseDigitalTwinEnv.reset" title="Link to this definition">¶</a></dt>
<dd><p>Resets the internal state, with the option of setting the physical state and digital state distribution.
The options dictionary keys are “physical_state” and “digital_state_distro” respectively.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seed</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – a seed for the environment’s pseudo random generator. Defaults to None.</p></li>
<li><p><strong>options</strong> (<em>Optional</em><em>[</em><em>dict</em><em>]</em><em>, </em><em>optional</em>) – a dictionary of options. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an observation of the new state, and a dictionary of extra informations</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[np.ndarray, Dict[str, np.ndarray]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pgmtwin.core.env.BaseDigitalTwinEnv.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.env.BaseDigitalTwinEnv.step" title="Link to this definition">¶</a></dt>
<dd><p>Applies the given action to the PhysicalAsset and assimilates a new set of observations of the updated physical state
through the digital asset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>action</strong> (<em>int</em>) – the action to be applied</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>observation, reward, terminated, truncated, info dictionary</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[np.ndarray, float, bool, bool, Dict[str, np.ndarray]]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-pgmtwin.core.pgm">
<span id="pgmtwin-core-pgm-module"></span><h2>pgmtwin.core.pgm module<a class="headerlink" href="#module-pgmtwin.core.pgm" title="Link to this heading">¶</a></h2>
<p>Utilities for processing dependencies and building Dynamic Bayesian Networks from them.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pgmtwin.core.pgm.compress_dependencies">
<span class="sig-prename descclassname"><span class="pre">pgmtwin.core.pgm.</span></span><span class="sig-name descname"><span class="pre">compress_dependencies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dependencies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpd_smoothing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.pgm.compress_dependencies" title="Link to this definition">¶</a></dt>
<dd><p>Process the dependencies to generate a new set where:
- every output has a single dependency grouping all inputs
- every node is present in all frames</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dependencies</strong> (<em>List</em><em>[</em><a class="reference internal" href="#pgmtwin.core.dependency.Dependency" title="pgmtwin.core.dependency.Dependency"><em>Dependency</em></a><em>]</em>) – the list of dependencies to process</p></li>
<li><p><strong>cpd_smoothing</strong> (<em>bool</em><em>, </em><em>optional</em>) – smoothing when normalizing combined cpds. Defaults to 0.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether to print debug messages. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the processed list of dependencies</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="#pgmtwin.core.dependency.Dependency" title="pgmtwin.core.dependency.Dependency">Dependency</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pgmtwin.core.pgm.dbn_inference">
<span class="sig-prename descclassname"><span class="pre">pgmtwin.core.pgm.</span></span><span class="sig-name descname"><span class="pre">dbn_inference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dbn_infer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inference_keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evidence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evidence_sampled_distros</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_weighting</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.pgm.dbn_inference" title="Link to this definition">¶</a></dt>
<dd><p>Performs inference experiments on the given dbn, via sampling of the evidence nodes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dbn_infer</strong> (<em>DBNInference</em>) – the dbn to infer from</p></li>
<li><p><strong>inference_keys</strong> (<em>List</em><em>[</em><em>Tuple</em><em>[</em><em>str</em><em>, </em><em>int</em><em>]</em><em>]</em>) – the list of output variables</p></li>
<li><p><strong>evidence</strong> (<em>Dict</em><em>[</em><em>Tuple</em><em>[</em><em>str</em><em>, </em><em>int</em><em>]</em><em>, </em><em>int</em><em>]</em>) – hard evidence, these nodes will be fixed and not sampled</p></li>
<li><p><strong>n_samples</strong> (<em>int</em>) – number of samples to draw from the product of evidence_sampled_distros</p></li>
<li><p><strong>evidence_sampled_distros</strong> (<em>Optional</em><em>[</em><em>Dict</em><em>[</em><em>Tuple</em><em>[</em><em>str</em><em>, </em><em>int</em><em>]</em><em>, </em><em>np.ndarray</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – pmf of each evidence node to be sampled. Defaults to None.</p></li>
<li><p><strong>rng</strong> (<em>Optional</em><em>[</em><em>np.random.Generator</em><em>]</em><em>, </em><em>optional</em>) – pseudo-random generator, will create a new one if None. Defaults to None.</p></li>
<li><p><strong>n_workers</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – number of parallel batches to split the workload in, or joblib.cpu_count(only_physical_cores=True) if None . Defaults to None.</p></li>
<li><p><strong>use_weighting</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether to sample considering the evidence distributions as weights. Defaults to True.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether to print debug messages. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – if the distributions are not given as np.ndarray</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the inferred distributions</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Dict[Tuple[str, int], np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pgmtwin.core.pgm.dbn_inference_worker">
<span class="sig-prename descclassname"><span class="pre">pgmtwin.core.pgm.</span></span><span class="sig-name descname"><span class="pre">dbn_inference_worker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dbn_infer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inference_keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evidence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evidence_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.pgm.dbn_inference_worker" title="Link to this definition">¶</a></dt>
<dd><p>Performs a batch of inference experiments via sampling</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dbn_infer</strong> (<em>DBNInference</em>) – the dbn to infer from</p></li>
<li><p><strong>inference_keys</strong> (<em>List</em><em>[</em><em>Tuple</em><em>[</em><em>str</em><em>, </em><em>int</em><em>]</em><em>]</em>) – the list of output variables</p></li>
<li><p><strong>evidence</strong> (<em>Dict</em><em>[</em><em>Tuple</em><em>[</em><em>str</em><em>, </em><em>int</em><em>]</em><em>, </em><em>np.ndarray</em><em>]</em>) – the sampled evidence for the evidence nodes</p></li>
<li><p><strong>evidence_weights</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – the weighting vector of the evidence samples, or None to use uniform weighting. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – if no samples were given for an evidence node</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the inferred sample count arrays</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Dict[Tuple[str, int], np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pgmtwin.core.pgm.draw_structured">
<span class="sig-prename descclassname"><span class="pre">pgmtwin.core.pgm.</span></span><span class="sig-name descname"><span class="pre">draw_structured</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dbn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_grid_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(5,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.pgm.draw_structured" title="Link to this definition">¶</a></dt>
<dd><p>Draws the given DynamicBayesianNetwork, controlling the placement on nodes based on their str name</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dbn</strong> (<em>DynamicBayesianNetwork</em>) – the DynamicBayesianNetwork to draw</p></li>
<li><p><strong>var_pos</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em><em>]</em>) – specifies the position of nodes, relative to a frame. The keys are the str part of nodes</p></li>
<li><p><strong>var_label</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em><em>, </em><em>optional</em>) – if given, converts the string part of the nodes to the specified value. Frames are rendered in square brackets. Defaults to None.</p></li>
<li><p><strong>var_color</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em><em>, </em><em>optional</em>) – if given, specifies the matplotlib color to paint the nodes of the corresponding variable. Defaults to None.</p></li>
<li><p><strong>var_shape</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em><em>, </em><em>optional</em>) – if given, specifies the matplotlib shape to draw the nodes of the corresponding variable. Frames are rendered in square brackets. Defaults to None.</p></li>
<li><p><strong>frame_grid_step</strong> (<em>Tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em><em>, </em><em>optional</em>) – the horizontal and vertical spacing between coordinates in a frame. Defaults to (5, 3).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pgmtwin.core.pgm.get_dbn">
<span class="sig-prename descclassname"><span class="pre">pgmtwin.core.pgm.</span></span><span class="sig-name descname"><span class="pre">get_dbn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dependencies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpd_smoothing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.pgm.get_dbn" title="Link to this definition">¶</a></dt>
<dd><p>Builds a DynamicBayesianNetwork from the given dependencies
The dependencies are first compressed, and the inputs, output relations become edges
The cpds are applied where available, and source nodes are given a priori uniform distributions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dependencies</strong> (<em>List</em><em>[</em><a class="reference internal" href="#pgmtwin.core.dependency.Dependency" title="pgmtwin.core.dependency.Dependency"><em>Dependency</em></a><em>]</em>) – the list of dependencies to process</p></li>
<li><p><strong>check_model</strong> (<em>bool</em><em>, </em><em>optional</em>) – check the dbn before returning it. Defaults to True</p></li>
<li><p><strong>cpd_smoothing</strong> (<em>bool</em><em>, </em><em>optional</em>) – smoothing when normalizing combined cpds. Defaults to 0.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether to print debug messages. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the constructed DynamicBayesianNetwork and the source nodes found</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[DynamicBayesianNetwork, List[Tuple[<a class="reference internal" href="#pgmtwin.core.variable.Variable" title="pgmtwin.core.variable.Variable">Variable</a>, int]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pgmtwin.core.pgm.get_filtered_discrete_metadata">
<span class="sig-prename descclassname"><span class="pre">pgmtwin.core.pgm.</span></span><span class="sig-name descname"><span class="pre">get_filtered_discrete_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dependencies</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.pgm.get_filtered_discrete_metadata" title="Link to this definition">¶</a></dt>
<dd><p>Retrieve new lists where non-discrete variables, and dependencies touching them, have been removed</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variables</strong> (<em>List</em><em>[</em><a class="reference internal" href="#pgmtwin.core.variable.Variable" title="pgmtwin.core.variable.Variable"><em>Variable</em></a><em>]</em>) – the list of variables to filter</p></li>
<li><p><strong>dependencies</strong> (<em>List</em><em>[</em><a class="reference internal" href="#pgmtwin.core.dependency.Dependency" title="pgmtwin.core.dependency.Dependency"><em>Dependency</em></a><em>]</em>) – the list of dependencies to filter</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the filtered variables and dependencies</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[List[<a class="reference internal" href="#pgmtwin.core.variable.Variable" title="pgmtwin.core.variable.Variable">Variable</a>], List[<a class="reference internal" href="#pgmtwin.core.dependency.Dependency" title="pgmtwin.core.dependency.Dependency">Dependency</a>]]</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pgmtwin.core.physical_asset">
<span id="pgmtwin-core-physical-asset-module"></span><h2>pgmtwin.core.physical_asset module<a class="headerlink" href="#module-pgmtwin.core.physical_asset" title="Link to this heading">¶</a></h2>
<p>Abstract and base implementation for a PhysicalAsset, which holds a state updated by Actions and generates observations</p>
<dl class="py class">
<dt class="sig sig-object py" id="pgmtwin.core.physical_asset.BasePhysicalAsset">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pgmtwin.core.physical_asset.</span></span><span class="sig-name descname"><span class="pre">BasePhysicalAsset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.physical_asset.BasePhysicalAsset" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Abstract class for a PhysicalAsset, which holds a state updated by Actions and generates observations</p>
<p>Initializes the PhysicalAsset with an initial state and a random number generator</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial_state</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – the initial state of the PhysicalAsset</p></li>
<li><p><strong>rng</strong> (<em>np.random.Generator</em><em>, </em><em>optional</em>) – the pseudo-random generator, or None to create a new one. Defaults to None.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pgmtwin.core.physical_asset.BasePhysicalAsset.get_observations">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_observations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_observations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.physical_asset.BasePhysicalAsset.get_observations" title="Link to this definition">¶</a></dt>
<dd><p>Retrieves a set of observations from the current state of the PhysicalAsset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n_observations</strong> (<em>int</em><em>, </em><em>optional</em>) – number of observation records to retrieve. Defaults to 1.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the observation generated from the current state</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pgmtwin.core.physical_asset.BasePhysicalAsset.set_state">
<span class="sig-name descname"><span class="pre">set_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.physical_asset.BasePhysicalAsset.set_state" title="Link to this definition">¶</a></dt>
<dd><p>Sets the current state of the PhysicalAsset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<em>np.ndarray</em>) – the new state to set</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pgmtwin.core.physical_asset.BasePhysicalAsset.update">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.physical_asset.BasePhysicalAsset.update" title="Link to this definition">¶</a></dt>
<dd><p>Updates the state of the PhysicalAsset by applying the given Action</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>action</strong> (<a class="reference internal" href="#pgmtwin.core.action.BaseAction" title="pgmtwin.core.action.BaseAction"><em>BaseAction</em></a>) – the action to apply to the current state</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the updated state of the PhysicalAsset</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pgmtwin.core.physical_asset.ComposablePhysicalAsset">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pgmtwin.core.physical_asset.</span></span><span class="sig-name descname"><span class="pre">ComposablePhysicalAsset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_update_component</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensor_component</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_component</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.physical_asset.ComposablePhysicalAsset" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pgmtwin.core.physical_asset.BasePhysicalAsset" title="pgmtwin.core.physical_asset.BasePhysicalAsset"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasePhysicalAsset</span></code></a></p>
<p>Component-based implementation of a PhysicalAsset, which enables the
customization of state updates, observations, and noise</p>
<p>Initializes the ComposablePhysicalAsset with an initial state and components for state updates, observations, and noise</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial_state</strong> (<em>np.ndarray</em>) – the initial state of the PhysicalAsset</p></li>
<li><p><strong>state_update_component</strong> (<a class="reference internal" href="pgmtwin.core.asset_components.html#pgmtwin.core.asset_components.state_update.StateUpdateComponent" title="pgmtwin.core.asset_components.state_update.StateUpdateComponent"><em>StateUpdateComponent</em></a>) – state update component to apply actions</p></li>
<li><p><strong>sensor_component</strong> (<a class="reference internal" href="pgmtwin.core.asset_components.html#pgmtwin.core.asset_components.observer.ObserverComponent" title="pgmtwin.core.asset_components.observer.ObserverComponent"><em>ObserverComponent</em></a>) – component to generate observations from the state</p></li>
<li><p><strong>noise_component</strong> (<a class="reference internal" href="pgmtwin.core.asset_components.html#pgmtwin.core.asset_components.observation_noise.BaseObservationNoiseComponent" title="pgmtwin.core.asset_components.observation_noise.BaseObservationNoiseComponent"><em>BaseObservationNoiseComponent</em></a><em>, </em><em>optional</em>) – component to add noise to observations</p></li>
<li><p><strong>rng</strong> (<em>np.random.Generator</em><em>, </em><em>optional</em>) – the pseudo-random generator, or None to create a new one. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – if state_update_component is None</p></li>
<li><p><strong>ValueError</strong> – if sensor_component is None</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pgmtwin.core.physical_asset.ComposablePhysicalAsset.get_observations">
<span class="sig-name descname"><span class="pre">get_observations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_observations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.physical_asset.ComposablePhysicalAsset.get_observations" title="Link to this definition">¶</a></dt>
<dd><p>Retrieves a set of observations from the current state of the PhysicalAsset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n_observations</strong> (<em>int</em><em>, </em><em>optional</em>) – number of observation records to retrieve. Defaults to 1.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the observation generated from the current state</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pgmtwin.core.physical_asset.ComposablePhysicalAsset.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.physical_asset.ComposablePhysicalAsset.update" title="Link to this definition">¶</a></dt>
<dd><p>Updates the state of the PhysicalAsset by applying the given Action</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>action</strong> (<a class="reference internal" href="#pgmtwin.core.action.BaseAction" title="pgmtwin.core.action.BaseAction"><em>BaseAction</em></a>) – the action to apply to the current state</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the updated state of the PhysicalAsset</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-pgmtwin.core.tabular_policy">
<span id="pgmtwin-core-tabular-policy-module"></span><h2>pgmtwin.core.tabular_policy module<a class="headerlink" href="#module-pgmtwin.core.tabular_policy" title="Link to this heading">¶</a></h2>
<p>Tabular policy utilities and classes</p>
<dl class="py class">
<dt class="sig sig-object py" id="pgmtwin.core.tabular_policy.TabularPolicy">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pgmtwin.core.tabular_policy.</span></span><span class="sig-name descname"><span class="pre">TabularPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">actions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_map_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.tabular_policy.TabularPolicy" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">PolicyPredictor</span></code></p>
<p>A tabular policy that predicts actions based on a discrete state domain and a set of actions.
Compatible with stable-baselines3 and gym environments.</p>
<p>Initializes the TabularPolicy with a state domain, actions, and a reward function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state_domain</strong> (<a class="reference internal" href="#pgmtwin.core.domain.DiscreteDomain" title="pgmtwin.core.domain.DiscreteDomain"><em>DiscreteDomain</em></a>) – the discrete state domain</p></li>
<li><p><strong>actions</strong> (<em>List</em><em>[</em><a class="reference internal" href="#pgmtwin.core.action.BaseAction" title="pgmtwin.core.action.BaseAction"><em>BaseAction</em></a><em>]</em>) – the list of actions available in the policy</p></li>
<li><p><strong>reward</strong> (<em>Callable</em><em>[</em><em>[</em><a class="reference internal" href="#pgmtwin.core.action.BaseAction" title="pgmtwin.core.action.BaseAction"><em>BaseAction</em></a><em>, </em><em>np.ndarray</em><em>]</em><em>, </em><em>float</em><em>]</em>) – the reward function that evaluates the action and state</p></li>
<li><p><strong>use_map_state</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether the policy whould use the maximum a posteriori state to act. Defaults to False.</p></li>
<li><p><strong>rng</strong> (<em>np.random.Generator</em><em>, </em><em>optional</em>) – the pseudo-random generator, or None to create a new one. Defaults to None.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pgmtwin.core.tabular_policy.TabularPolicy.fit_q_learning">
<span class="sig-name descname"><span class="pre">fit_q_learning</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_update</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_episodes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.tabular_policy.TabularPolicy.fit_q_learning" title="Link to this definition">¶</a></dt>
<dd><p>Fit the policy using Q-learning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state_update</strong> (<a class="reference internal" href="pgmtwin.core.asset_components.html#pgmtwin.core.asset_components.state_update.StateUpdateComponent" title="pgmtwin.core.asset_components.state_update.StateUpdateComponent"><em>StateUpdateComponent</em></a>) – the state update component to use for state transitions</p></li>
<li><p><strong>n_episodes</strong> (<em>int</em>) – number of episodes to run for training</p></li>
<li><p><strong>n_iters</strong> (<em>int</em>) – number of iterations per episode</p></li>
<li><p><strong>alpha</strong> (<em>float</em><em>, </em><em>optional</em>) – weighting factor for rewards+values. Defaults to 0.1.</p></li>
<li><p><strong>epsilon</strong> (<em>float</em><em>, </em><em>optional</em>) – the threshold for the construction of the epsilon-greedy policy. Defaults to 0.1.</p></li>
<li><p><strong>gamma</strong> (<em>float</em><em>, </em><em>optional</em>) – weighting factor for current values. Defaults to 0.9.</p></li>
<li><p><strong>deterministic</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether the resulting policy has a single action outcome, or a full probability distribution. Defaults to False.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether to print debug messages. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>policy matrix and Q-values</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[np.ndarray, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pgmtwin.core.tabular_policy.TabularPolicy.fit_value_iteration">
<span class="sig-name descname"><span class="pre">fit_value_iteration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_iters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.tabular_policy.TabularPolicy.fit_value_iteration" title="Link to this definition">¶</a></dt>
<dd><p>Fit the policy using value iteration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_iters</strong> (<em>int</em>) – number of iterations to run for training</p></li>
<li><p><strong>tol</strong> (<em>float</em><em>, </em><em>optional</em>) – tolerance for convergence, checcked on the maximum change in state values. Defaults to 1e-3.</p></li>
<li><p><strong>gamma</strong> (<em>float</em><em>, </em><em>optional</em>) – weighting factor. Defaults to 0.9.</p></li>
<li><p><strong>deterministic</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether the resulting policy has a single action outcome, or a full probability distribution. Defaults to False.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether to print debug messages. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the policy matrix and the Q-values for each state-action pair</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[np.ndarray, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pgmtwin.core.tabular_policy.TabularPolicy.get_action_rewards_for_state">
<span class="sig-name descname"><span class="pre">get_action_rewards_for_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">landing_rewards</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.tabular_policy.TabularPolicy.get_action_rewards_for_state" title="Link to this definition">¶</a></dt>
<dd><p>Computes the action values for a given state based on the landing rewards and state values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state_idx</strong> (<em>int</em>) – index of the starting state</p></li>
<li><p><strong>state_values</strong> (<em>np.ndarray</em>) – array of current values, n_states elements</p></li>
<li><p><strong>landing_rewards</strong> (<em>np.ndarray</em>) – array of shape (n_actions, n_states) with the landing rewards for each combination</p></li>
<li><p><strong>gamma</strong> (<em>float</em>) – weighting factor for future rewards</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array of action values</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pgmtwin.core.tabular_policy.TabularPolicy.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">episode_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.tabular_policy.TabularPolicy.predict" title="Link to this definition">¶</a></dt>
<dd><p>Get the policy action from an observation (and optional hidden state).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>observation</strong> (<em>Union</em><em>[</em><em>np.ndarray</em><em>, </em><em>dict</em><em>[</em><em>str</em><em>, </em><em>np.ndarray</em><em>]</em><em>]</em>) – the observation which describes the environment state</p></li>
<li><p><strong>state</strong> (<em>Optional</em><em>[</em><em>tuple</em><em>[</em><em>np.ndarray</em><em>, </em><em>...</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – optional hidden state. Defaults to None.</p></li>
<li><p><strong>episode_start</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – additional information to denote the start of a new episode. Defaults to None.</p></li>
<li><p><strong>deterministic</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether the policy selects the action deterministically or via sampling. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the index of the selected action, and the new hidden state (if applicable)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[np.ndarray, Optional[tuple[np.ndarray, …]]]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pgmtwin.core.tabular_policy.get_landing_rewards">
<span class="sig-prename descclassname"><span class="pre">pgmtwin.core.tabular_policy.</span></span><span class="sig-name descname"><span class="pre">get_landing_rewards</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">actions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.tabular_policy.get_landing_rewards" title="Link to this definition">¶</a></dt>
<dd><p>Computes the rewards for each combination of (action, ending state)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state_domain</strong> (<a class="reference internal" href="#pgmtwin.core.domain.DiscreteDomain" title="pgmtwin.core.domain.DiscreteDomain"><em>DiscreteDomain</em></a>) – description of the digital state domain</p></li>
<li><p><strong>actions</strong> (<em>List</em><em>[</em><a class="reference internal" href="#pgmtwin.core.action.BaseAction" title="pgmtwin.core.action.BaseAction"><em>BaseAction</em></a><em>]</em>) – list of actions</p></li>
<li><p><strong>reward</strong> (<em>Callable</em><em>[</em><em>[</em><a class="reference internal" href="#pgmtwin.core.action.BaseAction" title="pgmtwin.core.action.BaseAction"><em>BaseAction</em></a><em>]</em><em>, </em><em>np.ndarray</em><em>]</em>) – reward function that takes an action and a state</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether to print debug messages. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a 2d array of rewards, with shape (n_actions, n_states)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pgmtwin.core.tabular_policy.plot_landing_rewards">
<span class="sig-prename descclassname"><span class="pre">pgmtwin.core.tabular_policy.</span></span><span class="sig-name descname"><span class="pre">plot_landing_rewards</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">actions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">landing_rewards</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap=&lt;matplotlib.colors.ListedColormap</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.tabular_policy.plot_landing_rewards" title="Link to this definition">¶</a></dt>
<dd><p>Helper method to plot the landing rewards with action and value labels</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state_domain</strong> (<a class="reference internal" href="#pgmtwin.core.domain.DiscreteDomain" title="pgmtwin.core.domain.DiscreteDomain"><em>DiscreteDomain</em></a>) – the digital state domain</p></li>
<li><p><strong>actions</strong> (<em>List</em><em>[</em><a class="reference internal" href="#pgmtwin.core.action.BaseAction" title="pgmtwin.core.action.BaseAction"><em>BaseAction</em></a><em>]</em>) – the list of actions</p></li>
<li><p><strong>landing_rewards</strong> (<em>np.ndarray</em>) – a 2d array of rewards, with shape (n_actions, n_states)</p></li>
<li><p><strong>cmap</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Colormap</em><em>]</em><em>, </em><em>optional</em>) – the colormap to use. Defaults to CMAP_BLUES.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pgmtwin.core.tabular_policy.plot_tabular_policy">
<span class="sig-prename descclassname"><span class="pre">pgmtwin.core.tabular_policy.</span></span><span class="sig-name descname"><span class="pre">plot_tabular_policy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">policy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap=&lt;matplotlib.colors.ListedColormap</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.tabular_policy.plot_tabular_policy" title="Link to this definition">¶</a></dt>
<dd><p>Helper method to represent the tabular policy with action and value labels</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>policy</strong> (<a class="reference internal" href="#pgmtwin.core.tabular_policy.TabularPolicy" title="pgmtwin.core.tabular_policy.TabularPolicy"><em>TabularPolicy</em></a>) – the tabular policy to plot</p></li>
<li><p><strong>cmap</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Colormap</em><em>]</em><em>, </em><em>optional</em>) – the colormap to use. Defaults to CMAP_BLUES.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pgmtwin.core.utils">
<span id="pgmtwin-core-utils-module"></span><h2>pgmtwin.core.utils module<a class="headerlink" href="#module-pgmtwin.core.utils" title="Link to this heading">¶</a></h2>
<p>General utilities for the pgmtwin library</p>
<dl class="py class">
<dt class="sig sig-object py" id="pgmtwin.core.utils.PrefixLogFilter">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pgmtwin.core.utils.</span></span><span class="sig-name descname"><span class="pre">PrefixLogFilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg_prefix</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.utils.PrefixLogFilter" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Filter</span></code></p>
<p>Helper class to filter log messages with a given prefix</p>
<p>Initialize a filter.</p>
<p>Initialize with the name of the logger which, together with its
children, will have its events allowed through the filter. If no
name is specified, allow every event.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pgmtwin.core.utils.PrefixLogFilter.filter">
<span class="sig-name descname"><span class="pre">filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">record</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.utils.PrefixLogFilter.filter" title="Link to this definition">¶</a></dt>
<dd><p>Determine if the specified record is to be logged.</p>
<p>Returns True if the record should be logged, or False otherwise.
If deemed appropriate, the record may be modified in-place.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pgmtwin.core.utils.SingletonMeta">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pgmtwin.core.utils.</span></span><span class="sig-name descname"><span class="pre">SingletonMeta</span></span><a class="headerlink" href="#pgmtwin.core.utils.SingletonMeta" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">type</span></code></p>
<p>Metaclass for implementing Singleton pattern.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pgmtwin.core.utils.filter_kwargs">
<span class="sig-prename descclassname"><span class="pre">pgmtwin.core.utils.</span></span><span class="sig-name descname"><span class="pre">filter_kwargs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.utils.filter_kwargs" title="Link to this definition">¶</a></dt>
<dd><p>Filters a kwargs dictionary to retain only the arguments accepted by the given callable</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<em>_type_</em>) – a callable</p></li>
<li><p><strong>kwargs</strong> (<em>dict</em>) – a kwargs dictionary</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a kwargs dictionary compatible with func</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pgmtwin.core.utils.get_combined_cpd_pair">
<span class="sig-prename descclassname"><span class="pre">pgmtwin.core.utils.</span></span><span class="sig-name descname"><span class="pre">get_combined_cpd_pair</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.utils.get_combined_cpd_pair" title="Link to this definition">¶</a></dt>
<dd><p>A and B are two cpd factors resulting in the same variable
This method assembles the tensor from the 2d observation to the output,
so that the input variables of the factors are concatenated</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<em>np.ndarray</em>) – the first cpd factor</p></li>
<li><p><strong>B</strong> (<em>np.ndarray</em>) – the second cpd factor</p></li>
<li><p><strong>smoothing</strong> (<em>float</em><em>, </em><em>optional</em>) – a quantity to distribute across the elements of each column, to smooth the zero elements</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the combined cpd factor</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pgmtwin.core.utils.get_combined_cpds">
<span class="sig-prename descclassname"><span class="pre">pgmtwin.core.utils.</span></span><span class="sig-name descname"><span class="pre">get_combined_cpds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cpds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.utils.get_combined_cpds" title="Link to this definition">¶</a></dt>
<dd><p>Takes a list of factor cpds and assembles the tensor
from the product space of the factors, to the output</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cpds</strong> (<em>List</em><em>[</em><em>np.ndarray</em><em>]</em>) – a list of 2d arrays, each representing a cpd factor</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the combined cpd factor</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pgmtwin.core.utils.get_combined_transitions_from_block">
<span class="sig-prename descclassname"><span class="pre">pgmtwin.core.utils.</span></span><span class="sig-name descname"><span class="pre">get_combined_transitions_from_block</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_dims</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.utils.get_combined_transitions_from_block" title="Link to this definition">¶</a></dt>
<dd><p>Assembles the transition matrix for the product of n_dims factor variables,
each independently transitioning according to transition</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transition</strong> (<em>np.ndarray</em>) – a 2d (n_states, n_states) matrix whose columns sum to 1</p></li>
<li><p><strong>n_dims</strong> (<em>int</em>) – number of dimensions to combine</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a 2d (n_states**n_dims, n_states**n_dims) matrix whose columns sum to 1</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pgmtwin.core.utils.get_epsilon_greedy_policy">
<span class="sig-prename descclassname"><span class="pre">pgmtwin.core.utils.</span></span><span class="sig-name descname"><span class="pre">get_epsilon_greedy_policy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action_state_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.utils.get_epsilon_greedy_policy" title="Link to this definition">¶</a></dt>
<dd><p>Generates an epsilon-greedy policy based on the action-state values.
The highest value action has a probability of 1 - epsilon, while all other actions have a probability of epsilon / n_actions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>action_state_values</strong> (<em>np.ndarray</em>) – an array of shape (n_actions, n_states) with action-state values</p></li>
<li><p><strong>epsilon</strong> (<em>float</em><em>, </em><em>optional</em>) – the probability threshold for random selection. Defaults to 1e-3.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array of shape (n_actions, n_states) with the epsilon-greedy policy distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pgmtwin.core.utils.get_lower_transitions_block">
<span class="sig-prename descclassname"><span class="pre">pgmtwin.core.utils.</span></span><span class="sig-name descname"><span class="pre">get_lower_transitions_block</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jump_probs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.utils.get_lower_transitions_block" title="Link to this definition">¶</a></dt>
<dd><p>Assembles the transition matrix for a stochastic state regression
jump_probs[i] is the probability of a transition from state j to j + i</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_states</strong> (<em>int</em>) – number of states in the system</p></li>
<li><p><strong>jump_probs</strong> (<em>np.ndarray</em>) – an array of probabilities for each jump</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a 2d (n_states, n_states) matrix whose columns sum to 1</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pgmtwin.core.utils.get_number_from_text">
<span class="sig-prename descclassname"><span class="pre">pgmtwin.core.utils.</span></span><span class="sig-name descname"><span class="pre">get_number_from_text</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">txt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">re_group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.utils.get_number_from_text" title="Link to this definition">¶</a></dt>
<dd><p>Extracts a numeric value from a string.
e.g. get_number_from_text(“code010_202.ext”, re_group=-1) -&gt; 202
e.g. get_number_from_text(“code010_202.ext”, re_group=0) -&gt; 10</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>txt</strong> (<em>str</em>) – the string to extract the number from</p></li>
<li><p><strong>re_group</strong> (<em>int</em><em>, </em><em>optional</em>) – index of the group to be extracted. Defaults to -1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the integer value converted from a consecutive group of digits,</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
<p>at the requested position in the list of all groups of digits in fname.
Does not handle minus sign nor decimal point</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – if no digits are found in the string</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pgmtwin.core.utils.get_transition_matrix_from_history">
<span class="sig-prename descclassname"><span class="pre">pgmtwin.core.utils.</span></span><span class="sig-name descname"><span class="pre">get_transition_matrix_from_history</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_idx_from</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_idx_to</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.utils.get_transition_matrix_from_history" title="Link to this definition">¶</a></dt>
<dd><p>Assembles the transition matrix from a history of state transitions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_states</strong> (<em>int</em>) – number of states in the system</p></li>
<li><p><strong>state_idx_from</strong> (<em>np.ndarray</em>) – history of starting state indices</p></li>
<li><p><strong>state_idx_to</strong> (<em>np.ndarray</em>) – history of ending state indices</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a 2d (n_states, n_states) matrix whose columns sum to 1</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pgmtwin.core.utils.get_upper_transitions_block">
<span class="sig-prename descclassname"><span class="pre">pgmtwin.core.utils.</span></span><span class="sig-name descname"><span class="pre">get_upper_transitions_block</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jump_probs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.utils.get_upper_transitions_block" title="Link to this definition">¶</a></dt>
<dd><p>Assembles the transition matrix for a stochastic state regression
jump_probs[i] is the probability of a transition from state j to j - i</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_states</strong> (<em>int</em>) – number of states in the system</p></li>
<li><p><strong>jump_probs</strong> (<em>np.ndarray</em>) – an array of probabilities for each jump</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a 2d (n_states, n_states) matrix whose columns sum to 1</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pgmtwin.core.utils.normalize_cpd">
<span class="sig-prename descclassname"><span class="pre">pgmtwin.core.utils.</span></span><span class="sig-name descname"><span class="pre">normalize_cpd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cpd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.utils.normalize_cpd" title="Link to this definition">¶</a></dt>
<dd><p>Normalizes a conditional probability distribution to ensure that its columns sum to 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cpd</strong> (<em>np.ndarray</em>) – a 2d array to normalize</p></li>
<li><p><strong>smoothing</strong> (<em>float</em><em>, </em><em>optional</em>) – a quantity to distribute across the elements of each column, to smooth the zero elements</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the normalized conditional probability distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pgmtwin.core.utils.pgmpy_suppress_cpd_replacement_warning">
<span class="sig-prename descclassname"><span class="pre">pgmtwin.core.utils.</span></span><span class="sig-name descname"><span class="pre">pgmpy_suppress_cpd_replacement_warning</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.utils.pgmpy_suppress_cpd_replacement_warning" title="Link to this definition">¶</a></dt>
<dd><p>Context manager to filter log messages from pgmpy, about replacing an existing CPD</p>
<dl class="field-list simple">
<dt class="field-odd">Yields<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>PrefixLogFilter</em> – a filter that suppresses messages about replacing existing CPDs</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pgmtwin.core.utils.pgmpy_suppress_cpd_sum_warning">
<span class="sig-prename descclassname"><span class="pre">pgmtwin.core.utils.</span></span><span class="sig-name descname"><span class="pre">pgmpy_suppress_cpd_sum_warning</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.utils.pgmpy_suppress_cpd_sum_warning" title="Link to this definition">¶</a></dt>
<dd><p>Context manager to filter log messages from pgmpy, about cpd normalization</p>
<dl class="field-list simple">
<dt class="field-odd">Yields<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>PrefixLogFilter</em> – a filter that suppresses messages about CPD values not summing to 1</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pgmtwin.core.utils.plot_discrete_domain_confusion_matrix">
<span class="sig-prename descclassname"><span class="pre">pgmtwin.core.utils.</span></span><span class="sig-name descname"><span class="pre">plot_discrete_domain_confusion_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confusion_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ticklabels=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorbar=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap=&lt;matplotlib.colors.ListedColormap</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.utils.plot_discrete_domain_confusion_matrix" title="Link to this definition">¶</a></dt>
<dd><p>Plots a confusion matrix using the given DiscreteDomain for the tick labels</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state_domain</strong> (<a class="reference internal" href="#pgmtwin.core.domain.DiscreteDomain" title="pgmtwin.core.domain.DiscreteDomain"><em>DiscreteDomain</em></a>) – the state domain</p></li>
<li><p><strong>confusion_matrix</strong> (<em>np.ndarray</em>) – the collected observation counts [true, predicted]</p></li>
<li><p><strong>ticklabels</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – the labels for the states, or None to use the values from the domain. Defaults to None.</p></li>
<li><p><strong>normalize</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether to normalize rows to obtain the probability of misprediction. Defaults to True.</p></li>
<li><p><strong>colorbar</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether to draw a colorbar. Defaults to True.</p></li>
<li><p><strong>cmap</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Colormap</em><em>]</em><em>, </em><em>optional</em>) – the colormap to use. Defaults to CMAP_BLUES.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pgmtwin.core.utils.sample_joint_distributions">
<span class="sig-prename descclassname"><span class="pre">pgmtwin.core.utils.</span></span><span class="sig-name descname"><span class="pre">sample_joint_distributions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pmfs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.utils.sample_joint_distributions" title="Link to this definition">¶</a></dt>
<dd><p>Generate at most n_samples indices from the given probability mass functions, in descending order of joint probability
Returns both the sequence of indices and the corresponding probabilities</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_samples</strong> (<em>int</em>) – number of samples to draw</p></li>
<li><p><strong>pmfs</strong> (<em>np.ndarray</em>) – arrays defining the probability mass functions</p></li>
<li><p><strong>rng</strong> (<em>np.random.Generator</em><em>, </em><em>optional</em>) – pseudo-random generator, or None to create a new one. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list of sampled index records, and probabilities of the corresponding sample</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[List[List[int]], np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pgmtwin.core.utils.softmax">
<span class="sig-prename descclassname"><span class="pre">pgmtwin.core.utils.</span></span><span class="sig-name descname"><span class="pre">softmax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.utils.softmax" title="Link to this definition">¶</a></dt>
<dd><p>Get a Boltzmann/Gibbs distribution computed form the given array
The array is flattenend before the computation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>np.ndarray</em>) – the input array to compute the softmax from</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the softmax distribution computed from the input array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pgmtwin.core.variable">
<span id="pgmtwin-core-variable-module"></span><h2>pgmtwin.core.variable module<a class="headerlink" href="#module-pgmtwin.core.variable" title="Link to this heading">¶</a></h2>
<p>Definitions for the metadata of a variable in a Probabilistic Graphical Model
Such metadata are used during construction of the underlying DynamicBayesianNetwork</p>
<dl class="py class">
<dt class="sig sig-object py" id="pgmtwin.core.variable.Variable">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pgmtwin.core.variable.</span></span><span class="sig-name descname"><span class="pre">Variable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distribution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discrete</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pgmtwin.core.variable.Variable" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Metadata for a variable in a Probabilistic Graphical Model</p>
<p>Sets the metadata for the variable
The domain can either be an array of shape (n_elems, 2) so that domain[i] = [lb, ub] for a continuous variable, or a DiscreteDomain</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – the name of the variable</p></li>
<li><p><strong>distribution</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether the variable’s evidence comes as a single record, or as a probability distribution. Defaults to False.</p></li>
<li><p><strong>discrete</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether the variables has discrete state values or not. Defaults to True.</p></li>
<li><p><strong>domain</strong> (<em>Union</em><em>[</em><em>np.ndarray</em><em>, </em><a class="reference internal" href="#pgmtwin.core.domain.DiscreteDomain" title="pgmtwin.core.domain.DiscreteDomain"><em>DiscreteDomain</em></a><em>]</em><em>, </em><em>optional</em>) – the domain for the states. Discrete variables use a DiscreteDomain instance, while continuous variables take an array of shape (n_features, 2) with lower and upper bounds of each feature. Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pgmtwin.core">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pgmtwin.core" title="Link to this heading">¶</a></h2>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">pgmtwin.core package</a><ul>
<li><a class="reference internal" href="#subpackages">Subpackages</a></li>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-pgmtwin.core.action">pgmtwin.core.action module</a><ul>
<li><a class="reference internal" href="#pgmtwin.core.action.ActionCPD"><code class="docutils literal notranslate"><span class="pre">ActionCPD</span></code></a><ul>
<li><a class="reference internal" href="#pgmtwin.core.action.ActionCPD.apply"><code class="docutils literal notranslate"><span class="pre">ActionCPD.apply()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.action.ActionCPD.get_transition_probabilities"><code class="docutils literal notranslate"><span class="pre">ActionCPD.get_transition_probabilities()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pgmtwin.core.action.BaseAction"><code class="docutils literal notranslate"><span class="pre">BaseAction</span></code></a><ul>
<li><a class="reference internal" href="#pgmtwin.core.action.BaseAction.apply"><code class="docutils literal notranslate"><span class="pre">BaseAction.apply()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.action.BaseAction.get_transition_probabilities"><code class="docutils literal notranslate"><span class="pre">BaseAction.get_transition_probabilities()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pgmtwin.core.action.plot_action_transitions"><code class="docutils literal notranslate"><span class="pre">plot_action_transitions()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-pgmtwin.core.dependency">pgmtwin.core.dependency module</a><ul>
<li><a class="reference internal" href="#pgmtwin.core.dependency.Dependency"><code class="docutils literal notranslate"><span class="pre">Dependency</span></code></a><ul>
<li><a class="reference internal" href="#pgmtwin.core.dependency.Dependency.get_timestep_copy"><code class="docutils literal notranslate"><span class="pre">Dependency.get_timestep_copy()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.dependency.Dependency.merge"><code class="docutils literal notranslate"><span class="pre">Dependency.merge()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-pgmtwin.core.digital_asset">pgmtwin.core.digital_asset module</a><ul>
<li><a class="reference internal" href="#pgmtwin.core.digital_asset.BaseDigitalAsset"><code class="docutils literal notranslate"><span class="pre">BaseDigitalAsset</span></code></a><ul>
<li><a class="reference internal" href="#pgmtwin.core.digital_asset.BaseDigitalAsset.assimilate"><code class="docutils literal notranslate"><span class="pre">BaseDigitalAsset.assimilate()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.digital_asset.BaseDigitalAsset.get_assimilation"><code class="docutils literal notranslate"><span class="pre">BaseDigitalAsset.get_assimilation()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.digital_asset.BaseDigitalAsset.get_assimilation_distribution"><code class="docutils literal notranslate"><span class="pre">BaseDigitalAsset.get_assimilation_distribution()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.digital_asset.BaseDigitalAsset.reset_state_distribution"><code class="docutils literal notranslate"><span class="pre">BaseDigitalAsset.reset_state_distribution()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pgmtwin.core.digital_asset.InverseProblemConfusionDigitalAsset"><code class="docutils literal notranslate"><span class="pre">InverseProblemConfusionDigitalAsset</span></code></a><ul>
<li><a class="reference internal" href="#pgmtwin.core.digital_asset.InverseProblemConfusionDigitalAsset.assimilate"><code class="docutils literal notranslate"><span class="pre">InverseProblemConfusionDigitalAsset.assimilate()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.digital_asset.InverseProblemConfusionDigitalAsset.get_assimilation"><code class="docutils literal notranslate"><span class="pre">InverseProblemConfusionDigitalAsset.get_assimilation()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.digital_asset.InverseProblemConfusionDigitalAsset.get_assimilation_cpd"><code class="docutils literal notranslate"><span class="pre">InverseProblemConfusionDigitalAsset.get_assimilation_cpd()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.digital_asset.InverseProblemConfusionDigitalAsset.get_assimilation_distribution"><code class="docutils literal notranslate"><span class="pre">InverseProblemConfusionDigitalAsset.get_assimilation_distribution()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-pgmtwin.core.domain">pgmtwin.core.domain module</a><ul>
<li><a class="reference internal" href="#pgmtwin.core.domain.DiscreteDomain"><code class="docutils literal notranslate"><span class="pre">DiscreteDomain</span></code></a><ul>
<li><a class="reference internal" href="#pgmtwin.core.domain.DiscreteDomain.index2multi_index"><code class="docutils literal notranslate"><span class="pre">DiscreteDomain.index2multi_index()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.domain.DiscreteDomain.index2values"><code class="docutils literal notranslate"><span class="pre">DiscreteDomain.index2values()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.domain.DiscreteDomain.merge_domains"><code class="docutils literal notranslate"><span class="pre">DiscreteDomain.merge_domains()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.domain.DiscreteDomain.multi_index2index"><code class="docutils literal notranslate"><span class="pre">DiscreteDomain.multi_index2index()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.domain.DiscreteDomain.multi_index2values"><code class="docutils literal notranslate"><span class="pre">DiscreteDomain.multi_index2values()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.domain.DiscreteDomain.sample_indices"><code class="docutils literal notranslate"><span class="pre">DiscreteDomain.sample_indices()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.domain.DiscreteDomain.sample_values"><code class="docutils literal notranslate"><span class="pre">DiscreteDomain.sample_values()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.domain.DiscreteDomain.values2index"><code class="docutils literal notranslate"><span class="pre">DiscreteDomain.values2index()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.domain.DiscreteDomain.values2multi_index"><code class="docutils literal notranslate"><span class="pre">DiscreteDomain.values2multi_index()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.domain.DiscreteDomain.values2values"><code class="docutils literal notranslate"><span class="pre">DiscreteDomain.values2values()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-pgmtwin.core.env">pgmtwin.core.env module</a><ul>
<li><a class="reference internal" href="#pgmtwin.core.env.BaseDigitalTwinEnv"><code class="docutils literal notranslate"><span class="pre">BaseDigitalTwinEnv</span></code></a><ul>
<li><a class="reference internal" href="#pgmtwin.core.env.BaseDigitalTwinEnv.metadata"><code class="docutils literal notranslate"><span class="pre">BaseDigitalTwinEnv.metadata</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.env.BaseDigitalTwinEnv.reset"><code class="docutils literal notranslate"><span class="pre">BaseDigitalTwinEnv.reset()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.env.BaseDigitalTwinEnv.step"><code class="docutils literal notranslate"><span class="pre">BaseDigitalTwinEnv.step()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-pgmtwin.core.pgm">pgmtwin.core.pgm module</a><ul>
<li><a class="reference internal" href="#pgmtwin.core.pgm.compress_dependencies"><code class="docutils literal notranslate"><span class="pre">compress_dependencies()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.pgm.dbn_inference"><code class="docutils literal notranslate"><span class="pre">dbn_inference()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.pgm.dbn_inference_worker"><code class="docutils literal notranslate"><span class="pre">dbn_inference_worker()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.pgm.draw_structured"><code class="docutils literal notranslate"><span class="pre">draw_structured()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.pgm.get_dbn"><code class="docutils literal notranslate"><span class="pre">get_dbn()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.pgm.get_filtered_discrete_metadata"><code class="docutils literal notranslate"><span class="pre">get_filtered_discrete_metadata()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-pgmtwin.core.physical_asset">pgmtwin.core.physical_asset module</a><ul>
<li><a class="reference internal" href="#pgmtwin.core.physical_asset.BasePhysicalAsset"><code class="docutils literal notranslate"><span class="pre">BasePhysicalAsset</span></code></a><ul>
<li><a class="reference internal" href="#pgmtwin.core.physical_asset.BasePhysicalAsset.get_observations"><code class="docutils literal notranslate"><span class="pre">BasePhysicalAsset.get_observations()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.physical_asset.BasePhysicalAsset.set_state"><code class="docutils literal notranslate"><span class="pre">BasePhysicalAsset.set_state()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.physical_asset.BasePhysicalAsset.update"><code class="docutils literal notranslate"><span class="pre">BasePhysicalAsset.update()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pgmtwin.core.physical_asset.ComposablePhysicalAsset"><code class="docutils literal notranslate"><span class="pre">ComposablePhysicalAsset</span></code></a><ul>
<li><a class="reference internal" href="#pgmtwin.core.physical_asset.ComposablePhysicalAsset.get_observations"><code class="docutils literal notranslate"><span class="pre">ComposablePhysicalAsset.get_observations()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.physical_asset.ComposablePhysicalAsset.update"><code class="docutils literal notranslate"><span class="pre">ComposablePhysicalAsset.update()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-pgmtwin.core.tabular_policy">pgmtwin.core.tabular_policy module</a><ul>
<li><a class="reference internal" href="#pgmtwin.core.tabular_policy.TabularPolicy"><code class="docutils literal notranslate"><span class="pre">TabularPolicy</span></code></a><ul>
<li><a class="reference internal" href="#pgmtwin.core.tabular_policy.TabularPolicy.fit_q_learning"><code class="docutils literal notranslate"><span class="pre">TabularPolicy.fit_q_learning()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.tabular_policy.TabularPolicy.fit_value_iteration"><code class="docutils literal notranslate"><span class="pre">TabularPolicy.fit_value_iteration()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.tabular_policy.TabularPolicy.get_action_rewards_for_state"><code class="docutils literal notranslate"><span class="pre">TabularPolicy.get_action_rewards_for_state()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.tabular_policy.TabularPolicy.predict"><code class="docutils literal notranslate"><span class="pre">TabularPolicy.predict()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pgmtwin.core.tabular_policy.get_landing_rewards"><code class="docutils literal notranslate"><span class="pre">get_landing_rewards()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.tabular_policy.plot_landing_rewards"><code class="docutils literal notranslate"><span class="pre">plot_landing_rewards()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.tabular_policy.plot_tabular_policy"><code class="docutils literal notranslate"><span class="pre">plot_tabular_policy()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-pgmtwin.core.utils">pgmtwin.core.utils module</a><ul>
<li><a class="reference internal" href="#pgmtwin.core.utils.PrefixLogFilter"><code class="docutils literal notranslate"><span class="pre">PrefixLogFilter</span></code></a><ul>
<li><a class="reference internal" href="#pgmtwin.core.utils.PrefixLogFilter.filter"><code class="docutils literal notranslate"><span class="pre">PrefixLogFilter.filter()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pgmtwin.core.utils.SingletonMeta"><code class="docutils literal notranslate"><span class="pre">SingletonMeta</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.utils.filter_kwargs"><code class="docutils literal notranslate"><span class="pre">filter_kwargs()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.utils.get_combined_cpd_pair"><code class="docutils literal notranslate"><span class="pre">get_combined_cpd_pair()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.utils.get_combined_cpds"><code class="docutils literal notranslate"><span class="pre">get_combined_cpds()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.utils.get_combined_transitions_from_block"><code class="docutils literal notranslate"><span class="pre">get_combined_transitions_from_block()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.utils.get_epsilon_greedy_policy"><code class="docutils literal notranslate"><span class="pre">get_epsilon_greedy_policy()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.utils.get_lower_transitions_block"><code class="docutils literal notranslate"><span class="pre">get_lower_transitions_block()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.utils.get_number_from_text"><code class="docutils literal notranslate"><span class="pre">get_number_from_text()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.utils.get_transition_matrix_from_history"><code class="docutils literal notranslate"><span class="pre">get_transition_matrix_from_history()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.utils.get_upper_transitions_block"><code class="docutils literal notranslate"><span class="pre">get_upper_transitions_block()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.utils.normalize_cpd"><code class="docutils literal notranslate"><span class="pre">normalize_cpd()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.utils.pgmpy_suppress_cpd_replacement_warning"><code class="docutils literal notranslate"><span class="pre">pgmpy_suppress_cpd_replacement_warning()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.utils.pgmpy_suppress_cpd_sum_warning"><code class="docutils literal notranslate"><span class="pre">pgmpy_suppress_cpd_sum_warning()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.utils.plot_discrete_domain_confusion_matrix"><code class="docutils literal notranslate"><span class="pre">plot_discrete_domain_confusion_matrix()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.utils.sample_joint_distributions"><code class="docutils literal notranslate"><span class="pre">sample_joint_distributions()</span></code></a></li>
<li><a class="reference internal" href="#pgmtwin.core.utils.softmax"><code class="docutils literal notranslate"><span class="pre">softmax()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-pgmtwin.core.variable">pgmtwin.core.variable module</a><ul>
<li><a class="reference internal" href="#pgmtwin.core.variable.Variable"><code class="docutils literal notranslate"><span class="pre">Variable</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-pgmtwin.core">Module contents</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="pgmtwin.html"
                          title="previous chapter">pgmtwin package</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="pgmtwin.core.asset_components.html"
                          title="next chapter">pgmtwin.core.asset_components package</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/pgmtwin.core.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="pgmtwin.core.asset_components.html" title="pgmtwin.core.asset_components package"
             >next</a> |</li>
        <li class="right" >
          <a href="pgmtwin.html" title="pgmtwin package"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pgmtwin 0.0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="modules.html" >pgmtwin</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="pgmtwin.html" >pgmtwin package</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">pgmtwin.core package</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2025, Lorenzo Fabris.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    </div>
  </body>
</html>